<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XState Parallel States (병렬 상태)</title>
  </head>
  <body>
    <h2>7. Parallel States - 동시 실행 상태</h2>
    <div>
      <h3>오디오</h3>
      <button id="audioToggle">오디오 토글</button>
      <span id="audioStatus">꺼짐</span>
    </div>

    <div>
      <h3>비디오</h3>
      <button id="videoToggle">비디오 토글</button>
      <span id="videoStatus">꺼짐</span>
    </div>

    <div>
      <h3>네트워크</h3>
      <button id="networkToggle">연결 토글</button>
      <span id="networkStatus">오프라인</span>
    </div>

    <script src="https://unpkg.com/xstate@4.38.3/dist/xstate.js"></script>
    <script>
      const { createMachine } = XState;

      const mediaMachine = createMachine({
        id: "media",
        type: "parallel",
        states: {
          audio: {
            initial: "off",
            states: {
              off: { on: { AUDIO_TOGGLE: "on" } },
              on: { on: { AUDIO_TOGGLE: "off" } },
            },
          },
          video: {
            initial: "off",
            states: {
              off: { on: { VIDEO_TOGGLE: "on" } },
              on: { on: { VIDEO_TOGGLE: "off" } },
            },
          },
          network: {
            initial: "offline",
            states: {
              offline: { on: { NETWORK_TOGGLE: "online" } },
              online: { on: { NETWORK_TOGGLE: "offline" } },
            },
          },
        },
      });

      let state = mediaMachine.initialState;

      function updateUI() {
        document.getElementById("audioStatus").textContent = state.matches({
          audio: "on",
        })
          ? "켜짐"
          : "꺼짐";

        document.getElementById("videoStatus").textContent = state.matches({
          video: "on",
        })
          ? "켜짐"
          : "꺼짐";

        document.getElementById("networkStatus").textContent = state.matches({
          network: "online",
        })
          ? "온라인"
          : "오프라인";
      }

      function send(event) {
        state = mediaMachine.transition(state, event);
        updateUI();
      }

      document.getElementById("audioToggle").onclick = () =>
        send("AUDIO_TOGGLE");
      document.getElementById("videoToggle").onclick = () =>
        send("VIDEO_TOGGLE");
      document.getElementById("networkToggle").onclick = () =>
        send("NETWORK_TOGGLE");

      updateUI();
    </script>
  </body>
</html>
